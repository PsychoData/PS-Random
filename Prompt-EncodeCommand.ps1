# https://github.com/PsychoData/PS-Random/blob/master/Prompt-EncodeCommand.ps1
# iex ( iex ( iex ( [string](0..6255|%{[char][int](31+("60848583747972620917151520172424930692606873668362607479856209192312090323222526261725252426252124242324182119191917191719201923201720172625181826242322242024252418252523242322242625212617232418211921201818241821172519251921201719252017192620171924192619252017192019261923192519231920192019202018192019261920192619211924192120171921192220181924191920172018192319251921192619191926192419252017201719241925192319251921192619252017192020171926192519231920192019211921192119201920192319201920191919241920201819211922192119261921192219211924192120171921192619211921192020181920201819211920192120171920201819211925192020181921192519211920192119251921192319202018192119241921201719211925192119251921192519212017192119261921192419211924192120171921191919211921192119231921192219211924192119231921192619211920192119251921192119211924192119231921192419211924192119251921192419211924192120171920201819202018192119261921192219211924192120171921192619211921192119201921192519211926192119251921192519211920192119251921192119211925192119241921192419212017192020181920201819202018192119261920201819211926192119191921192119211925192119261921192519212017192119261921192219202018192020181920201819211922192119261921192219211924192120171921192619211921192020181921201719202018192020181921191919211921192119261921192619211925192120171921192619211920192020181920201819202018192119261921191919211921192119251921192619211925192120171921192619211922192020181920201819202018192119221921192619211922192119261921192019211926192119231921192419212017192020181921201719202018192120171920201819202018192120171921191919202018192119221921192619211922192119241921201719211926192119211920201819202018192119201921201719202018192020181921192319202018192119241921201719211924192119231921192419211926192119191921192119211922192020181921192519212017192119261921192119211926192119221920201819202018192119191921192119211922192119261921192619211920192119251921201719211925192119251921192619202018192119261921192219202018192020181920201819211925192119231921192319211925192119201921192419211923192119261921192219202018192020181921192619211921192119261921192219211926192119201921192519211921192119251921192619211925192119191920201819202018192119261921192519211925192120171921192619211923192119251921192419211924192119261920201819202018192119261921201719211925192120171921192619211923192020181920201819211925192119241921192519211921192119251921192319211924192120171920201819202018192119261921192219211925192120171920201819202018192119241921201719211925192119261921192419211925192119251921201719211924192119261921192419212017192119211921191919202018192119251920201819202018192120171921192119211920192119251920201819202018192020181921192219211926192119191921192619211925192119261921192119211924192119231920201819202018192119201921201719202018192020181921192319212017192119241921192519211925192119201921192419211923192119261921192019211923192120171921192419211919192119241921191919202018192119221921192619211922192119241921201719211926192119211920201819202018192120171921192019202018192020181920201819211923192120171921191919202018192020181921192319212017192119251921192119211925192119261921192619211922192119241921191919202018192119221921192419211921192120171921192119211920192119251920201819211922192119261921192419211926192119261921192619211921192020181920201819211920192120171920201819202018192020181921192619202018192119221921192619211919192119261921192519211926192119211921192419211923192020181920201819212017192119201920201819202018192119251921192519211924192120171921192419211923192119261921192119211926192119231921192619211920192119241921201719202018192020181921191919211921192119221921192319211924192119231921192619211926192119251921192119211925192119251921192619211923192119251921192519202018192020181921201719211920192020181920201819211926192119211921192419212017192119251921192419211924192120171921192419211925192119261921192219202018192020181921191919211921192119211921192519211926192119261921192619202018192119241921192319211925192119261921192419211926192119221921192619211926192119201921192519212017192119261920201819211924192120171921192619211920192119261921192219211926192120171920201819202018192119221921192319211924192119231921192619211926192119251921192119211925192119251921192619211923192119251921192519202018192020181920201819212017192119191921192119211920192119231921192019211923192119201921192519202018192119221921192519211921192119261921192319202018192020181921192019212017192020181920201819202018192119261920201819211922192119261921191919211926192119251921192619211921192119241921192319202018192020181921201719211920192020181920201819211925192119251921192419212017192119241921192319211926192119211921192619211923192119261921192019211924192120171920201819202018192119191921192119211922192119231921192519211921192119251921192619211925192119211921192519211925192119261921192319211925192119251920201819202018192120171921192019202018192020181921192619211921192119241921201719211925192119241921192419212017192119241921192519211926192119221920201819202018192119191921192119211921192119251921192619211926192119261920201819211924192119231921192519211926192119241921192619211922192119261921192619211920192119251921201719211926192020181921192419212017192119261921192019211926192119221921192619212017192020181920201819211922192119231921192519211921192119251921192619211925192119211921192519211925192119261921192319211925192119251920201819202018192020181921201719202018192020181921192019211925192119251921192119211925192020181920201819202018192020181921192619202018192119221921192619211924192119261921192619211926192119211920201819202018192119191921192119211925192119191921192619211922192020181920201819202018192119221921192519211921192119261921192319202018192120171920201819202018192120171921191919211923192119231921192619211920192119251921192119211926192119221921192419212017192119191921192119211921192119251921192619211920192119261921192019211925192120171921192619211920192020181920201819202018192119201921192319211925192119251921201719211926192119231921192619211920192020181920201819211926192119211921192619211922192119261921192019211925192119211921192519211926192119251921191919202018192020181921192519211920192119241921192319211926192119211920201819202018192119241921192519211925192119201921192419211923192119261921192019211924192119231921192419211925192119261921192219211924192120171921192619211920192119261921192119202018192020181921192619211922192119251921201719211925192120171920201819202018192119251920201819211924192119231921192619211920192020181920201819211924192119231921192619202018192119241921192319211926192119201921192619211922192020181920201819211925192119211921192519211926192020181920201819211926192119221921192519211920192119241921201719202018192020181921192119211921192119261921192119211924192119251921192519211921192119251921192119202018192020181921192619211922192119241921192319211924192119241921192519211924192119241921201719211919192119221920201819202018192119261921192219211926192119201921192619212017192020181920201819211926192119211921192519212017192119251921192519211924192120171921192619211922192119251921192019211925192119211921192519211926192119251921191919202018192020181921192419212017192119251921192419211926192119211921192419212017192020181921192019202018192020181921192019211925192120171921192119211924192120171921192519211924192119261921192119211924192120171921201719211919192020181921192219211926192119251921192419212017192020181920201819211920192120171920201819202018192020181921192219211926192119241921192619211926192119261921192119211919192119221921191919211922192020181921192219211925192119211921192619211923192020181920201819212017192119201920201819202018192119211921201719211924192120171921192619211922192119191921192119211923192020181921192419211923192119251921192619211924192119261921192519212017192119251921192519211920192119251920201819202018192020181921192219211926192020181921192519212017192119251921191919202018192020181921192019212017192020181920201819202018192020181921192319212017192119241921192519211925192119201921192419211923192119261921192019211923192120171921192419211919192119241921191919202018192119221921192619211922192119241921201719211926192119211920201819202018192120171921192019202018192020181920201819211923192120171921191919202018192020181920201819211926192119231921201719211925192119211921192519211926192119261921192219211924192119191920201819211922192119241921192119202018192020181921191919211921192020181920201819202018192119221921192619211925192119241921201719202018192120171921191919211922192119231921192019211925192120171921192319211919192119261921192219211926192119201921192519211921192119251921192619211925192119191920201819211926192020181921192019211919192119241921191919211924192020181921192019202018192120171920201819202018192120171921192119202018192020181921192019211925192020181921192219211926192119191921192619211919192119261921191919202018192020181921192019212017192020181920201819202018192119201921192319212017192119261921192119211926192119221921192619211920192119251921192119211925192119261921192519211919192119241921191919202018192119261921191919211924192119191921192219211919192119221920201819211922192020181921192619202018192119221921192619211922192119241921201719211926192119211921191919211922192119221921192219211924192120171921192519211926192119251921191919211926192119221921192519211920192119191921192119211919192119251920201819212017192120171921192019202018192119231921201719211919192119231921201719211924192119251921192519211920192119241921192319211926192119201921192419211919192119231921201719211925192119211921192519211926192119261921192219211924192119191920201819211926192020181921192219211926192119251921192419212017192119191921191919202018192119261921192419211922192020181921192019202018192119221920201819211926192020181921192219211926192020181921192519212017192119251921191919211919192119211921192519211922192119251921201719211925192119211921192519211926192020181920201819202018192119251920201819211925192020181921201719211924192119221920201819211920192020181921201719211919192119221921192619211921192119261921192319211924192119241921192619211921192119261921192219211926192119201921192519211921192119251921192619211925192119191920201819211926192020181921192619211924192119221920201819211922192119241921192119211919192020181921191919211926192020181921201719211919192119201921191919211926192020181921201719202018192120171921201719211921192020181921201719202018192020181921191919211921192119261921192019211924192120171921192619202018192119251921192419211924192119231921192419211925192119241921201719202018192020181921192419211922192020181921192019211924192020181921192619211921192020181921192619211921192119191921192019212017192119241920201819211923192119191920201819212017192119241921192219202018192119201920201819202018192119191921192119211926192119201921192419212017192119261920201819211925192119241921192419211923192119241921192519211924192120171920201819202018192020181921192519202018192020181920201819202018192020181921192519211919192119201920201819211925192020181920201819202018192119251920201819202018192020181921192019202018192020181921192019211925192020181920201819202018192119221921192619211919192119261921191919211926192119191920201819202018192119201921192519211925192119211921192419212017192119261921192619202018192119261920201819211922192119261921191919211926192119191921192619211919192020181921201719211920192119251920201819202018192020181921192219211926192119191921192619211919192119261921191919202018192020181921201719211920192020181920201819211926192119211921192419211925192119241921192419211920192119251921201719211921192020181920201819191924192019211920192620171925201720171925201820171925201719262017192419261925201719201926192319201920192019201919192619251925192019221921192019201921192019241921192019201921192019212018192519201921191919221920192520171924192619212017192219262018192520171926191919261921191919221919192419251922201719251920192019221923192219211925192219241923192019211919192419191922192019252017192419261921201719221926201819252017192619191926192119191922192019191919192219191922192019191920192419201919191919221920191919191922172518221917252626182419252626172525242625212424182118211817232618231921182218251921182218222626182217231826252524222523251924182420242217231725232325261821202420222323222418221725172318262525242225232519241824202422172318201723172318201825182017231820172303101584866784858374797209090564111910131910109410011483708177666870010361840932306152100301148370817766687001080101081308010801").substring(($_*2),2))}) -replace "\s(?=\S)" -replace '  ',' ' ))) | clip 

 $stringToEncode =''
 Remove-Variable stringToEncode
 while ((-not $stringToEncode) -xor (-not $true)) {$stringToEncode = Read-Host -Prompt 'What string would you like to encode?' }
  $qwsa = [char[]]$stringToEncode | %{ [int]$_}
  $minOffset = ($qwsa | measure -Maximum | select -ExpandProperty Maximum )-99
  $maxOffset = ($qwsa | measure -Minimum | select -ExpandProperty Minimum ) 
  if ($minOffset -gt $maxOffset) {
    Write-Error "Your string has characters too far apart in the Ascii table. try something else" 
  }else{$chosenOffset = $minOffset..$maxOffset | Get-Random
  $stringOffset =  [char[]]$stringToEncode | %{ ([int]$_ - $chosenOffset).ToString("00") } 
  $OutputEncodedString = "[string](0..$($stringToEncode.Length-1)|%{[char][int]($chosenOffset+(`"$($stringOffset-join '')`").substring((`$_*2),2))}) -replace `"\s(?=\S)`" -replace '  ',' ' " 

  #Print String
  Write-Verbose 'Encoded string and command' -Verbose
  $OutputEncodedString 

  Write-Verbose 'Command that the above encoded string will produce' -Verbose
  Invoke-Expression($OutputEncodedString)

  Write-Verbose 'Encoded Command has been copied to clipboard' -Verbose
   $OutputEncodedString | Set-Clipboard
  } 
